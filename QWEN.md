# Smart Start Page - Проектная документация

## Обзор проекта

Smart Start Page - это современная, адаптивная стартовая страница, построенная на Next.js 14 с использованием Tailwind CSS. Проект предоставляет пользовательский интерфейс с возможностью настройки закладок, тем оформления, поисковых систем и фоновых изображений. Приложение ориентировано на персонализацию и удобство использования, с особым вниманием к работе на мобильных устройствах.

### Основные функции:
- Персонализированные группы закладок с возможностью перетаскивания
- Настройка тем оформления (светлая/темная)
- Выбор и настройка фоновых изображений
- Настраиваемые поисковые системы
- Тематические пресеты оформления
- Адаптивный дизайн для мобильных устройств
- Панель док-станции для быстрого доступа к группам

### Технологии:
- Next.js 14 (App Router)
- React 18
- Tailwind CSS
- Font Awesome (иконки)
- LocalStorage (для хранения настроек)

## Структура проекта

```
smart-start-next/
├── public/                 # Публичные ресурсы
├── src/
│   ├── app/               # Основные страницы и компоненты
│   │   ├── components/    # Переиспользуемые компоненты
│   │   ├── favicon.ico
│   │   ├── globals.css    # Глобальные стили (генерируется из main.tailwindcss)
│   │   ├── layout.js      # Основной макет приложения
│   │   └── page.js        # Главная страница
│   │   └── main.tailwindcss # Основной файл стилей Tailwind
│   └── lib/               # Вспомогательные функции и константы
│       ├── constants.js   # Константы приложения
│       ├── hooks.js       # Пользовательские хуки
│       └── utils.js       # Вспомогательные функции
├── .gitignore
├── eslint.config.mjs
├── jsconfig.json
├── next.config.mjs        # Конфигурация Next.js
├── package.json
├── postbuild.py           # Скрипт для деплоя на github автоматически (не запускать!) (readonly!)
├── postcss.config.mjs     
└── tailwind.config.js     # Конфигурация Tailwind CSS
```

## Сборка и запуск

### Установка зависимостей
```bash
npm install
```

### Запуск в режиме разработки
```bash
# Запуск CSS билдера и сервера разработки одновременно
npm run dev:css

# Или отдельно:
npm run css  # Компиляция стилей
npm run dev  # Запуск сервера разработки
```

### Сборка проекта
```bash
# Сборка CSS и проекта
npm run build:css  # равноценно == npm run css && npm run build

# Или отдельно:
npm run build:css  # Компиляция стилей для продакшена
npm run build      # Сборка проекта для продакшена
```

### Запуск продакшен-версии
```bash
npm start
```

## Особенности реализации

### Стили и CSS
- Используется Tailwind CSS с кастомными компонентами и утилитами
- Глобальные стили определены в `src/app/main.tailwindcss`
- CSS переменные используются для динамической настройки цветов и эффектов
- Для оптимизации производительности используются `transform: translateZ(0)` и `will-change`

### Проблема с фоновыми изображениями на мобильных устройствах
Проект сталкивался с известной проблемой: при скроллинге на мобильных устройствах фоновые изображения "дрожали" и "подпрыгивали". Это связано с использованием `background-attachment: fixed` в сочетании с особенностями мобильных браузеров.

#### Решение:
Проблема была решена комплексным подходом, включающим изменение типа прикрепления фона и добавление оптимизаций для стабилизации отображения на мобильных устройствах:

1. Для всех устройств:
   - Добавлены оптимизации для GPU: `transform: translateZ(0)`, `will-change: transform`, `contain: paint`

2. Для мобильных устройств (ширина до 768px):
   - Используем `background-attachment: scroll` вместо `fixed`
   - Добавлены дополнительные оптимизации: `backface-visibility: hidden`, `perspective: 1000px`

3. Для iOS Safari:
   - Дополнительно применяем правило через `@supports (-webkit-touch-callout: none)`

Вот ключевые изменения в CSS:
```css
/* Обои - самый нижний слой */
.wallpaper-overlay {
    /* ... остальные стили ... */
    
    /* Оптимизация для GPU */
    transform: translateZ(0);
    will-change: transform;
    contain: paint;
}

/* На мобильных устройствах используем scroll вместо fixed для лучшей совместимости */
@media (max-width: 768px) {
    .wallpaper-overlay {
        background-attachment: scroll;
        /* Дополнительные оптимизации для мобильных */
        transform: translateZ(0);
        will-change: transform;
        contain: paint;
        /* Убираем возможные сдвиги при скроллинге */
        backface-visibility: hidden;
        perspective: 1000px;
    }
}

/* Альтернативное решение для iOS Safari */
@supports (-webkit-touch-callout: none) {
    .wallpaper-overlay {
        background-attachment: scroll;
        transform: translateZ(0);
        will-change: transform;
        contain: paint;
    }
}
```

### Дополнительное изменение: Разделение Dock Bar для мобильных и десктопных устройств

Также было изменено поведение панели Dock:

- Созданы отдельные компоненты: `MobileDock.js` для мобильных устройств и `DesktopDock.js` для десктопных
- Удален старый общий компонент `DockBar.js`
- Мобильная версия сохраняет текущее поведение с фиксацией внизу экрана
- Десктопная версия реализована в стиле macOS с эффектом увеличения при наведении
- В компоненте `SearchInput.js` добавлена проверка на мобильное устройство
- На мобильных устройствах панель Dock не скрывается при фокусе на поле поиска
- Панель Dock всегда остается видимой на мобильных устройствах, если выбран макет "dock"
```

### Хранение данных
- Все пользовательские настройки хранятся в LocalStorage
- Реализована проверка ограничений по объему хранилища (до 9.5 МБ)
- Данные синхронизируются с состоянием React через useEffect

### Адаптивный дизайн
- Используются медиа-запросы для адаптации под разные размеры экранов
- Разные соотношения сторон для элементов на мобильных устройствах
- Панель док-станции адаптируется под безопасные зоны на мобильных устройствах

## Разработка

### Соглашения по коду
- Используется ESLint для проверки кода
- Стиль кода следует рекомендациям Next.js
- Компоненты разбиты на логические модули
- Используется клиентская маршрутизация React

### Тестирование
- Проект не содержит автоматических тестов (нужно добавить в будущем)
- Рекомендуется ручное тестирование на разных устройствах и браузерах

### Вклад в проект
1. Создайте форк репозитория
2. Создайте новую ветку для вашей функции
3. Внесите изменения
4. Убедитесь, что все работает корректно
5. Отправьте pull request

## Известные проблемы

1. **Ограничения LocalStorage**: Объем хранилища ограничен, и при достижении лимита новые данные не будут сохраняться.

## Возможные улучшения

1. **Добавление тестов**: Включить юнит- и интеграционные тесты для обеспечения качества кода.

2. **Улучшение доступности**: Добавить ARIA-атрибуты и улучшить навигацию с клавиатуры.

3. **Поддержка PWA**: Добавить манифест и сервис-воркер для возможности установки как приложения.

4. **Многоязычность**: Добавить поддержку нескольких языков с помощью i18n.
